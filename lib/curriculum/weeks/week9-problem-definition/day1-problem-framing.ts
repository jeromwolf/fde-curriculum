// Day 1: 비즈니스 문제 정의 & 구조화
import type { Task } from '../../types'

export const day1Tasks: Task[] = [
  {
    id: 'p2w1d1t1',
    type: 'video',
    title: 'FDE의 핵심 역량: 문제 정의',
    duration: 20,
    content: {
      objectives: [
        'FDE와 일반 데이터 분석가의 차이를 이해한다',
        '문제와 증상을 구분할 수 있다',
        '비즈니스 문제 정의의 중요성을 인식한다'
      ],
      videoUrl: '',
      transcript: `# FDE의 핵심 역량: 문제 정의

## Phase 2를 시작하며

Phase 1에서 데이터를 **수집, 처리, 저장**하는 파이프라인을 구축할 수 있게 되었습니다.

하지만 FDE는 단순히 "데이터를 다루는 사람"이 아닙니다.
**비즈니스 문제를 정의하고, 데이터로 해결책을 찾는 사람**입니다.

## FDE vs 일반 데이터 분석가

| 역할 | 시작점 | 핵심 질문 |
|------|--------|----------|
| **데이터 분석가** | "이 데이터 분석해주세요" | How? |
| **FDE** | "매출이 떨어지고 있어요" | Why? What? Then How? |

## 잘못된 접근 vs 올바른 접근

### 잘못된 접근
\`\`\`
"Python 배웠어요" → "Pandas 배웠어요" → "근데 뭘 분석해야 하죠?"
\`\`\`

### 올바른 접근
\`\`\`
"고객 이탈이 문제예요"
    → "어떤 데이터가 있죠?"
    → "가설을 세워봅시다"
    → "이걸 검증하려면 이런 분석이 필요해요"
    → "Python으로 구현합니다"
\`\`\`

## 문제 vs 증상

많은 사람들이 **증상**을 **문제**로 착각합니다.

\`\`\`
증상: "매출이 20% 감소했어요"
     ↓ Why?
문제: "신규 고객 유입은 동일한데 재구매율이 급감"
     ↓ Why?
근본 원인: "경쟁사 대비 배송 시간이 2배 → 고객 만족도 하락"
\`\`\`

### 증상과 문제의 차이

| 유형 | 예시 | 특징 |
|------|------|------|
| **증상** | 매출 20% 감소 | 결과, 관측 가능 |
| **문제** | 재구매율 급감 | 원인의 일부 |
| **근본 원인** | 배송 시간 증가 | 해결 가능한 지점 |

## 핵심 메시지

> "기술 역량(Phase 1) + 비즈니스 역량(Phase 2) = FDE의 차별화된 가치"

다음 강의에서 문제를 구조화하는 기법인 **5 Whys**와 **MECE**를 배워보겠습니다.
`,
      keyPoints: [
        'FDE는 "왜?"라는 질문에서 시작한다',
        '증상과 문제를 구분해야 한다',
        '근본 원인을 찾아야 실행 가능한 해결책이 나온다',
        '기술 + 비즈니스 역량이 FDE의 차별화 포인트'
      ]
    }
  },
  {
    id: 'p2w1d1t2',
    type: 'video',
    title: '5 Whys 기법',
    duration: 20,
    content: {
      objectives: [
        '5 Whys 기법의 원리를 이해한다',
        '근본 원인 분석에 5 Whys를 적용할 수 있다',
        '실제 비즈니스 사례에 5 Whys를 활용할 수 있다'
      ],
      videoUrl: '',
      transcript: `# 5 Whys 기법

## 5 Whys란?

**5 Whys**는 도요타 생산 시스템(TPS)에서 개발된 근본 원인 분석 기법입니다.

핵심 아이디어:
> "왜?"라는 질문을 5번 반복하면 근본 원인에 도달한다

## 5 Whys 예시: 대시보드 장애

\`\`\`
1. Why: 대시보드 데이터가 업데이트 안 됨 → ETL 작업 실패
2. Why: ETL 작업이 왜 실패? → 소스 DB 연결 타임아웃
3. Why: 왜 타임아웃? → 쿼리 실행 시간 30분 초과
4. Why: 왜 쿼리가 느려졌나? → 테이블 10배 증가, 인덱스 없음
5. Why: 왜 인덱스가 없나? → 초기 설계 시 예측 실패

→ 근본 원인: 데이터 모델링/용량 계획 부재
→ 해결책: 인덱스 추가 + 파티셔닝 + 모니터링
\`\`\`

## 5 Whys 예시: 고객 이탈

\`\`\`
1. Why: 고객 이탈률이 증가했다 → 재구매율 급감
2. Why: 재구매율이 왜 떨어졌나? → 고객 만족도 하락
3. Why: 왜 만족도가 하락? → 배송 지연 불만 급증
4. Why: 왜 배송이 지연되나? → 물류 센터 처리량 한계
5. Why: 왜 처리량에 한계? → 주문량 200% 증가, 인력/시설 미확충

→ 근본 원인: 성장에 따른 물류 인프라 미비
→ 해결책: 물류 센터 확장 OR 3PL 파트너십
\`\`\`

## 5 Whys 적용 팁

### Do's (해야 할 것)
- 사실에 기반하여 질문하기
- 여러 관점에서 검증하기
- 팀과 함께 진행하기
- 5번에 집착하지 말고 근본 원인까지

### Don'ts (하지 말 것)
- 추측으로 답하기
- 책임 추궁용으로 사용하기
- 한 가지 원인만 고집하기

## 5 Whys의 한계

| 한계 | 보완 방법 |
|------|----------|
| 단일 원인만 추적 | **Fishbone Diagram** (다중 원인) |
| 정성적 분석만 | 데이터 분석으로 검증 |
| 주관적 답변 | 팀 토론으로 객관성 확보 |

## 핵심 메시지

> "5 Whys는 시작점입니다. 데이터로 가설을 검증하는 것이 FDE의 역할입니다."
`,
      keyPoints: [
        '5 Whys는 도요타에서 개발된 근본 원인 분석 기법',
        '"왜?"를 반복해서 표면 증상에서 근본 원인까지 도달',
        '5번은 가이드라인, 근본 원인에 도달하면 멈춤',
        '다중 원인이 있을 수 있으므로 Fishbone Diagram과 병행'
      ]
    }
  },
  {
    id: 'p2w1d1t3',
    type: 'video',
    title: 'MECE 프레임워크',
    duration: 25,
    content: {
      objectives: [
        'MECE의 의미와 중요성을 이해한다',
        '문제를 MECE하게 분해할 수 있다',
        '비즈니스 문제에 MECE를 적용할 수 있다'
      ],
      videoUrl: '',
      transcript: `# MECE 프레임워크

## MECE란?

**MECE** (Mutually Exclusive, Collectively Exhaustive)는 맥킨지에서 개발한 문제 분해 프레임워크입니다.

- **Mutually Exclusive (상호 배타적)**: 각 카테고리가 겹치지 않음
- **Collectively Exhaustive (전체 포괄적)**: 모든 가능성을 포함

## MECE 예시: 고객 이탈 원인

\`\`\`
문제: "왜 고객이 이탈하는가?"

MECE 분해:
┌─────────────────────────────────────────────┐
│              고객 이탈 원인                  │
├─────────────┬─────────────┬─────────────────┤
│   제품 문제  │  서비스 문제 │   외부 요인     │
├─────────────┼─────────────┼─────────────────┤
│ • 품질 불만  │ • 배송 지연  │ • 경쟁사 프로모션│
│ • 가격 불만  │ • CS 불만족  │ • 경기 침체     │
│ • 기능 부족  │ • 반품 어려움│ • 계절적 요인   │
└─────────────┴─────────────┴─────────────────┘

✅ 상호 배타적: 각 카테고리가 겹치지 않음
✅ 전체 포괄적: 모든 가능한 원인 포함
\`\`\`

## MECE가 아닌 분해 (Bad Example)

\`\`\`
❌ Not MECE:
┌────────────┬────────────┬────────────┐
│  가격 문제  │  CS 불만   │ 비싼 가격   │
└────────────┴────────────┴────────────┘

문제점:
1. "가격 문제"와 "비싼 가격"이 중복 (Not Mutually Exclusive)
2. 제품 품질, 경쟁사 등 누락 (Not Collectively Exhaustive)
\`\`\`

## MECE 분해 패턴

### 1. 프로세스 기반
\`\`\`
고객 여정: 인지 → 고려 → 구매 → 사용 → 재구매/이탈
\`\`\`

### 2. 구성 요소 기반
\`\`\`
매출 = 고객 수 × 구매 빈도 × 객단가
\`\`\`

### 3. 내부/외부 기반
\`\`\`
원인 = 내부 요인 (통제 가능) + 외부 요인 (통제 불가)
\`\`\`

### 4. 시간 기반
\`\`\`
매출 변화 = 단기 요인 + 중기 요인 + 장기 요인
\`\`\`

## MECE + 데이터 분석

\`\`\`
1. MECE로 가설 구조화
   └── 제품/서비스/외부 요인

2. 각 가설에 데이터 매핑
   └── 제품: 반품률, 리뷰 점수
   └── 서비스: 배송 시간, CS 만족도
   └── 외부: 경쟁사 가격, 시장 트렌드

3. 데이터 분석으로 가설 검증
   └── 어느 요인이 이탈과 가장 상관관계가 높은가?
\`\`\`

## 핵심 메시지

> "MECE는 빠짐없이, 겹치지 않게 문제를 분해하는 기술입니다."
`,
      keyPoints: [
        'MECE: 상호 배타적(겹치지 않음) + 전체 포괄적(빠짐없음)',
        '맥킨지에서 개발한 문제 분해 프레임워크',
        '프로세스, 구성요소, 내부/외부, 시간 등 다양한 분해 패턴',
        'MECE로 가설을 구조화하고 데이터로 검증'
      ]
    }
  },
  {
    id: 'p2w1d1t4',
    type: 'code',
    title: '실습: 비즈니스 문제 구조화',
    duration: 40,
    content: {
      objectives: [
        '실제 비즈니스 시나리오에 5 Whys를 적용한다',
        'MECE로 문제를 분해한다',
        '분석 가설을 수립한다'
      ],
      instructions: `# 비즈니스 문제 구조화 실습

이 실습에서는 실제 비즈니스 시나리오를 분석하여 문제를 구조화합니다.

## 시나리오

당신은 이커머스 회사의 데이터 분석가입니다.
경영진으로부터 다음과 같은 요청을 받았습니다:

> "지난 분기 대비 매출이 15% 감소했습니다. 원인을 분석해주세요."

## 과제

1. **5 Whys 분석**
   - 매출 감소의 근본 원인을 추적하세요
   - 각 단계에서 검증 가능한 가설을 세우세요

2. **MECE 분해**
   - 매출 감소 원인을 MECE하게 분해하세요
   - 최소 3개 레벨로 분해하세요

3. **데이터 요청 리스트**
   - 각 가설을 검증하기 위해 필요한 데이터를 정의하세요

## 제출 형식

아래 코드의 TODO를 채워주세요.
`,
      starterCode: `"""
비즈니스 문제 구조화 실습

시나리오: 이커머스 회사 매출 15% 감소 원인 분석
"""

# ============================================================
# Part 1: 5 Whys 분석
# ============================================================

five_whys_analysis = {
    "symptom": "매출이 지난 분기 대비 15% 감소",

    "why_1": {
        "question": "왜 매출이 감소했나?",
        "hypothesis": "",  # TODO: 가설 작성
        "data_needed": []  # TODO: 검증에 필요한 데이터
    },

    "why_2": {
        "question": "",  # TODO: 후속 질문
        "hypothesis": "",
        "data_needed": []
    },

    "why_3": {
        "question": "",
        "hypothesis": "",
        "data_needed": []
    },

    "why_4": {
        "question": "",
        "hypothesis": "",
        "data_needed": []
    },

    "why_5": {
        "question": "",
        "hypothesis": "",
        "data_needed": []
    },

    "root_cause": "",  # TODO: 근본 원인
    "proposed_solution": ""  # TODO: 제안 해결책
}


# ============================================================
# Part 2: MECE 분해
# ============================================================

mece_breakdown = {
    "problem": "매출 15% 감소 원인",

    "level_1": [
        # TODO: 최상위 MECE 분해 (3-4개 카테고리)
        # 예: "내부 요인", "외부 요인"
    ],

    "level_2": {
        # TODO: 각 level_1 카테고리의 하위 분해
        # 예: "내부 요인": ["제품", "가격", "마케팅"]
    },

    "level_3": {
        # TODO: 더 세부적인 분해 (선택사항)
    }
}


# ============================================================
# Part 3: 데이터 요청 리스트
# ============================================================

data_request_list = [
    # TODO: 분석에 필요한 데이터 목록
    # {
    #     "data_name": "월별 매출 데이터",
    #     "source": "ERP 시스템",
    #     "purpose": "매출 트렌드 분석",
    #     "priority": "High"
    # }
]


# ============================================================
# 결과 출력 함수
# ============================================================

def print_analysis_summary():
    """분석 결과를 요약하여 출력합니다."""

    print("=" * 60)
    print("📊 비즈니스 문제 분석 결과")
    print("=" * 60)

    print("\\n🔍 5 Whys 분석")
    print("-" * 40)
    print(f"증상: {five_whys_analysis['symptom']}")

    for i in range(1, 6):
        why = five_whys_analysis.get(f'why_{i}', {})
        if why.get('question'):
            print(f"\\nWhy {i}: {why['question']}")
            print(f"  가설: {why['hypothesis']}")
            print(f"  필요 데이터: {', '.join(why['data_needed'])}")

    print(f"\\n📌 근본 원인: {five_whys_analysis['root_cause']}")
    print(f"💡 제안 해결책: {five_whys_analysis['proposed_solution']}")

    print("\\n\\n📐 MECE 분해")
    print("-" * 40)
    print(f"문제: {mece_breakdown['problem']}")
    print(f"\\nLevel 1: {mece_breakdown['level_1']}")

    for category, subcategories in mece_breakdown.get('level_2', {}).items():
        print(f"  └── {category}: {subcategories}")

    print("\\n\\n📋 데이터 요청 리스트")
    print("-" * 40)
    for idx, data in enumerate(data_request_list, 1):
        print(f"{idx}. {data.get('data_name', 'N/A')}")
        print(f"   출처: {data.get('source', 'N/A')}")
        print(f"   목적: {data.get('purpose', 'N/A')}")
        print(f"   우선순위: {data.get('priority', 'N/A')}")


# 실행
if __name__ == "__main__":
    print_analysis_summary()
`,
      solutionCode: `"""
비즈니스 문제 구조화 실습 - 솔루션

시나리오: 이커머스 회사 매출 15% 감소 원인 분석
"""

# ============================================================
# Part 1: 5 Whys 분석
# ============================================================

five_whys_analysis = {
    "symptom": "매출이 지난 분기 대비 15% 감소",

    "why_1": {
        "question": "왜 매출이 감소했나?",
        "hypothesis": "주문 건수 또는 객단가가 감소했을 것이다",
        "data_needed": ["월별 주문 건수", "월별 평균 객단가", "월별 활성 고객 수"]
    },

    "why_2": {
        "question": "왜 주문 건수가 감소했나? (가정: 주문 건수 감소 확인)",
        "hypothesis": "신규 고객 유입 감소 또는 기존 고객 이탈 증가",
        "data_needed": ["신규/기존 고객별 주문 비중", "고객 코호트 재구매율", "이탈 고객 수"]
    },

    "why_3": {
        "question": "왜 기존 고객이 이탈했나? (가정: 기존 고객 재구매율 하락)",
        "hypothesis": "제품, 서비스, 가격 중 하나에 불만족이 증가했을 것이다",
        "data_needed": ["NPS 점수 추이", "CS 문의 유형별 통계", "반품/환불 사유"]
    },

    "why_4": {
        "question": "왜 서비스에 불만족했나? (가정: CS 불만 유형 중 배송 급증)",
        "hypothesis": "배송 시간이 길어졌거나 배송 품질이 하락했을 것이다",
        "data_needed": ["평균 배송 소요일 추이", "배송 지연 건수", "배송 관련 1점 리뷰"]
    },

    "why_5": {
        "question": "왜 배송 시간이 길어졌나?",
        "hypothesis": "물류 센터 처리량 한계 또는 택배사 문제",
        "data_needed": ["물류 센터별 처리량", "택배사별 배송 소요일", "주문량 대비 처리 능력"]
    },

    "root_cause": "급격한 주문량 증가(200%)에 물류 인프라가 따라가지 못해 배송 지연 발생, 이로 인한 고객 만족도 하락 및 재구매율 감소",
    "proposed_solution": "1) 단기: 택배사 추가 계약, 임시 물류 인력 확충\\n2) 중기: 물류 센터 확장 또는 3PL 파트너십\\n3) 장기: 지역별 분산 물류 시스템 구축"
}


# ============================================================
# Part 2: MECE 분해
# ============================================================

mece_breakdown = {
    "problem": "매출 15% 감소 원인",

    "level_1": [
        "거래 규모 감소",  # 주문 건수, 객단가
        "고객 기반 축소",  # 신규 유입, 기존 이탈
        "외부 환경 변화"   # 경쟁, 경기, 계절성
    ],

    "level_2": {
        "거래 규모 감소": [
            "주문 건수 감소",
            "평균 객단가 하락",
            "구매 빈도 감소"
        ],
        "고객 기반 축소": [
            "신규 고객 유입 감소",
            "기존 고객 이탈 증가",
            "휴면 고객 증가"
        ],
        "외부 환경 변화": [
            "경쟁사 프로모션",
            "경기 침체",
            "계절적 요인"
        ]
    },

    "level_3": {
        "기존 고객 이탈 증가": [
            "제품 불만 (품질, 가격, 다양성)",
            "서비스 불만 (배송, CS, 반품)",
            "경쟁사 전환"
        ],
        "서비스 불만": [
            "배송 지연",
            "배송 파손",
            "CS 응대 불만",
            "반품/교환 어려움"
        ]
    }
}


# ============================================================
# Part 3: 데이터 요청 리스트
# ============================================================

data_request_list = [
    {
        "data_name": "월별 매출 및 주문 데이터",
        "source": "ERP/주문 시스템",
        "purpose": "매출 트렌드 및 주문 건수/객단가 분해",
        "priority": "High"
    },
    {
        "data_name": "고객 코호트 분석 데이터",
        "source": "CRM 시스템",
        "purpose": "신규/기존 고객 비중 및 재구매율 분석",
        "priority": "High"
    },
    {
        "data_name": "NPS 및 고객 만족도 설문",
        "source": "고객 설문 시스템",
        "purpose": "불만족 요인 식별",
        "priority": "Medium"
    },
    {
        "data_name": "CS 문의 유형별 통계",
        "source": "CS 시스템",
        "purpose": "주요 불만 사항 정량화",
        "priority": "High"
    },
    {
        "data_name": "배송 소요일 및 지연 통계",
        "source": "물류 시스템",
        "purpose": "배송 지연 여부 확인",
        "priority": "High"
    },
    {
        "data_name": "물류 센터 처리량 데이터",
        "source": "WMS 시스템",
        "purpose": "처리 능력 대비 주문량 분석",
        "priority": "Medium"
    },
    {
        "data_name": "경쟁사 가격/프로모션 정보",
        "source": "마케팅팀 수집 자료",
        "purpose": "외부 요인 분석",
        "priority": "Low"
    }
]


# ============================================================
# 결과 출력 함수
# ============================================================

def print_analysis_summary():
    """분석 결과를 요약하여 출력합니다."""

    print("=" * 60)
    print("📊 비즈니스 문제 분석 결과")
    print("=" * 60)

    print("\\n🔍 5 Whys 분석")
    print("-" * 40)
    print(f"증상: {five_whys_analysis['symptom']}")

    for i in range(1, 6):
        why = five_whys_analysis.get(f'why_{i}', {})
        if why.get('question'):
            print(f"\\nWhy {i}: {why['question']}")
            print(f"  가설: {why['hypothesis']}")
            print(f"  필요 데이터: {', '.join(why['data_needed'])}")

    print(f"\\n📌 근본 원인: {five_whys_analysis['root_cause']}")
    print(f"💡 제안 해결책: {five_whys_analysis['proposed_solution']}")

    print("\\n\\n📐 MECE 분해")
    print("-" * 40)
    print(f"문제: {mece_breakdown['problem']}")
    print(f"\\nLevel 1: {mece_breakdown['level_1']}")

    for category, subcategories in mece_breakdown.get('level_2', {}).items():
        print(f"  └── {category}: {subcategories}")

    print("\\n\\n📋 데이터 요청 리스트")
    print("-" * 40)
    for idx, data in enumerate(data_request_list, 1):
        print(f"{idx}. {data.get('data_name', 'N/A')}")
        print(f"   출처: {data.get('source', 'N/A')}")
        print(f"   목적: {data.get('purpose', 'N/A')}")
        print(f"   우선순위: {data.get('priority', 'N/A')}")


# 실행
if __name__ == "__main__":
    print_analysis_summary()
`,
      hints: [
        '5 Whys는 가설을 세우고, 데이터로 검증하는 반복 과정입니다',
        'MECE Level 1은 가장 큰 카테고리로 시작하세요 (예: 내부/외부, 또는 고객/제품/운영)',
        '데이터 요청 시 "왜 이 데이터가 필요한지"를 명확히 하세요',
        '우선순위는 가설 검증에 가장 직접적인 데이터부터 High로 설정하세요'
      ]
    }
  },
  {
    id: 'p2w1d1t5',
    type: 'quiz',
    title: 'Day 1 퀴즈: 문제 정의',
    duration: 10,
    content: {
      questions: [
        {
          question: '"매출이 20% 감소했다"는 어떤 유형에 해당하나요?',
          options: [
            '근본 원인',
            '증상',
            '해결책',
            'MECE 분해'
          ],
          answer: 1,
          explanation: '매출 감소는 관측 가능한 결과이므로 "증상"입니다. 5 Whys를 통해 근본 원인을 찾아야 합니다.'
        },
        {
          question: '5 Whys 기법의 핵심 목적은 무엇인가요?',
          options: [
            '5가지 다른 문제를 분석하기 위해',
            '표면적 증상에서 근본 원인까지 도달하기 위해',
            '5명의 이해관계자 의견을 수집하기 위해',
            '5단계 프로세스를 정의하기 위해'
          ],
          answer: 1,
          explanation: '5 Whys는 "왜?"를 반복하여 표면적 증상에서 근본 원인까지 도달하는 분석 기법입니다.'
        },
        {
          question: 'MECE에서 "Mutually Exclusive"의 의미는?',
          options: [
            '각 카테고리가 모든 경우를 포함한다',
            '각 카테고리가 서로 겹치지 않는다',
            '카테고리가 5개 이하여야 한다',
            '우선순위가 명확해야 한다'
          ],
          answer: 1,
          explanation: 'Mutually Exclusive는 각 카테고리가 서로 겹치지 않음을 의미합니다. Collectively Exhaustive는 모든 경우를 포함한다는 의미입니다.'
        },
        {
          question: '다음 중 MECE하지 않은 분해는?',
          options: [
            '내부 요인 / 외부 요인',
            '신규 고객 / 기존 고객',
            '가격 문제 / 비싼 가격 / 서비스 문제',
            '제품 / 서비스 / 운영'
          ],
          answer: 2,
          explanation: '"가격 문제"와 "비싼 가격"은 중복되므로 Mutually Exclusive 조건을 위반합니다.'
        },
        {
          question: 'FDE가 일반 데이터 분석가와 다른 점은?',
          options: [
            'SQL을 더 잘 안다',
            '"왜?"라는 질문에서 시작하여 비즈니스 문제를 정의한다',
            '더 많은 차트를 만든다',
            'Python만 사용한다'
          ],
          answer: 1,
          explanation: 'FDE는 "이 데이터 분석해주세요"가 아니라 "왜 이런 문제가 발생했나?"에서 시작하여 비즈니스 문제를 정의하고 해결책을 찾습니다.'
        }
      ]
    }
  }
]
